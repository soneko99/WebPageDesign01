<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="../favicon/IMG_3967.png" type="image/x-icon">
    <title>AIãƒ„ãƒ¼ãƒ«ä¸€è¦§</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #1e1e1e;
            color: #f0f0f0;
            margin: 0;
            padding: 20px;
        }

        footer {
            background: #000;
            color: #fff;
            text-align: center;
            padding: 2rem 1rem;
        }

        .none-deco-a-tag {
            text-decoration: none;
            color: inherit;
        }

        h1 {
            text-align: center;
            color: #ffffff;
            margin-bottom: 10px;
        }

        .description {
            text-align: center;
            font-size: 0.95em;
            margin-bottom: 25px;
            line-height: 1.5;
            color: #ccc;
        }

        .description table {
            margin: 0 auto;
            font-size: 0.9em;
            border-collapse: collapse;
            color: #f0f0f0;
        }

        .description th,
        .description td {
            padding: 6px 12px;
            border: 1px solid #444;
        }

        table {
            width: auto;
            border-collapse: collapse;
            background-color: #2c2c2c;
        }

        th,
        td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #444;
        }

        th {
            background-color: #3a3a3a;
            color: #ffffff;
            cursor: pointer;
        }

        tr:hover {
            background-color: #383838;
        }

        a {
            color: #4ea1ff;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        select {
            margin-top: 4px;
            background-color: #2c2c2c;
            color: #f0f0f0;
            border: 1px solid #666;
            border-radius: 4px;
            font-size: 0.9em;
            width: 100%;
        }

        .accordion-header {
            background-color: #3a3a3a;
            color: #ffffff;
            cursor: pointer;
            padding: 10px;
            text-align: left;
            width: 100%;
            font-size: 1rem;
            transition: background-color 0.3s ease;
        }

        .accordion-header:focus {
            outline: 2px solid #4ea1ff;
        }

        .accordion-header:hover {
            background-color: #4a4a4a;
        }

        .accordion-content {
            display: none;
            padding: 10px;
            background-color: #2c2c2c;
            overflow: hidden;
        }

        .accordion-content table {
            width: 100%;
            border-collapse: collapse;
        }

        .accordion-content th,
        .accordion-content td {
            padding: 8px;
            border: 1px solid #444;
        }

        .accordion-content th {
            background-color: #3a3a3a;
            color: #ffffff;
        }
    </style>
</head>

<body>
    <a class="none-deco-a-tag" href="https://soneko99.github.io/WebPageDesign01/html/intoro.html">
        <h1>AIãƒ„ãƒ¼ãƒ«ä¸€è¦§</h1>
    </a>
    <div class="description">
        <strong>âœ… çµµæ–‡å­—ã‚¢ã‚¤ã‚³ãƒ³åŒ–æ¡ˆï¼ˆæ–™é‡‘ï¼‰</strong><br>
        <table>
            <tr>
                <th>åŒºåˆ†</th>
                <th>è¡¨ç¤ºã‚¢ã‚¤ã‚³ãƒ³</th>
                <th>èª¬æ˜</th>
            </tr>
            <tr>
                <td>ç„¡æ–™</td>
                <td>ğŸŸ¢ ç„¡æ–™</td>
                <td>èª°ã§ã‚‚ç„¡æ–™ã§ä½¿ãˆã‚‹</td>
            </tr>
            <tr>
                <td>æœ‰æ–™</td>
                <td>ğŸ”µ æœ‰æ–™</td>
                <td>æœ‰æ–™ãƒ—ãƒ©ãƒ³ä¸­å¿ƒ or æœˆé¡èª²é‡‘</td>
            </tr>
            <tr>
                <td>ä¸€éƒ¨ç„¡æ–™</td>
                <td>ğŸŸ¡ ä¸€éƒ¨ç„¡æ–™</td>
                <td>ãƒˆãƒ©ã‚¤ã‚¢ãƒ«ï¼ãƒ•ãƒªãƒ¼ãƒŸã‚¢ãƒ ãªã©</td>
            </tr>
            <tr>
                <td>Proé™å®š</td>
                <td>ğŸŸ£ Proé™å®š</td>
                <td>æœ‰æ–™ã‚µãƒ–ã‚¹ã‚¯å†…ã®æ©Ÿèƒ½ï¼ˆä¾‹ï¼šDALLÂ·E 3ï¼‰</td>
            </tr>
        </table>
    </div>
    <div id="accordion">
        <!-- ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒã“ã“ã«å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
    </div>
    <script>
        const searchInput = document.getElementById('searchInput');
        const accordion = document.getElementById('accordion');
        let originalData = [];
        let sortState = { key: '', isAscending: true }; // ã‚½ãƒ¼ãƒˆçŠ¶æ…‹ã‚’ä¿æŒ
        let filteredData = []; // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ

        fetch('../data/ai-tools.json')
            .then(response => response.json())
            .then(data => {
                originalData = data;
                renderAccordion(data);
                addEventListeners();
            });

        function renderAccordion(data) {
            accordion.innerHTML = '';
            const groupedData = groupBy(data, 'ã‚¸ãƒ£ãƒ³ãƒ«');
            Object.keys(groupedData).forEach(genre => {
                const section = document.createElement('div');
                section.innerHTML = `
                    <button class="accordion-header">${genre}</button>
                    <div class="accordion-content">
                        <table>
                            <thead>
                                <tr>
                                    <th data-key="ç”¨é€”">ç”¨é€”
                                        <select id="filterç”¨é€”-${genre}" onchange="filterTable('${genre}')">
                                            <option value="">å…¨ã¦</option>
                                        </select>
                                    </th>
                                    <th data-key="ãƒ„ãƒ¼ãƒ«å">ãƒ„ãƒ¼ãƒ«å</th>
                                    <th data-key="æ–™é‡‘">æ–™é‡‘
                                        <select id="filteræ–™é‡‘-${genre}" onchange="filterTable('${genre}')">
                                            <option value="">å…¨ã¦</option>
                                        </select>
                                    </th>
                                    <th data-key="NSFWå¯¾å¿œ">NSFW
                                        <select id="filterNSFW-${genre}" onchange="filterTable('${genre}')">
                                            <option value="">å…¨ã¦</option>
                                        </select>
                                    </th>
                                    <th data-key="å‚™è€ƒ">å‚™è€ƒ</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${groupedData[genre].map(item => `
                                    <tr>
                                        <td>${item['ç”¨é€”'] || ''}</td>
                                        <td><a href="${item['URL'] || '#'}" target="_blank">${item['ãƒ„ãƒ¼ãƒ«å'] || ''}</a></td>
                                        <td>${item['æ–™é‡‘'] || ''}</td>
                                        <td>${item['NSFWå¯¾å¿œ'] || ''}</td>
                                        <td>${item['å‚™è€ƒ'] || ''}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                accordion.appendChild(section);

                // å„ã‚¸ãƒ£ãƒ³ãƒ«ã”ã¨ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆ
                populateFilterOptions(document.getElementById(`filterç”¨é€”-${genre}`), 'ç”¨é€”', groupedData[genre]);
                populateFilterOptions(document.getElementById(`filteræ–™é‡‘-${genre}`), 'æ–™é‡‘', groupedData[genre]);
                populateFilterOptions(document.getElementById(`filterNSFW-${genre}`), 'NSFWå¯¾å¿œ', groupedData[genre]);
            });
            addAccordionListeners();
            addSortListeners(); // ã‚½ãƒ¼ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
        }

        function groupBy(array, key) {
            return array.reduce((result, currentValue) => {
                (result[currentValue[key]] = result[currentValue[key]] || []).push(currentValue);
                return result;
            }, {});
        }

        function addAccordionListeners() {
            const headers = document.querySelectorAll('.accordion-header');
            headers.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const isVisible = content.style.display === 'block';
                    document.querySelectorAll('.accordion-content').forEach(c => c.style.display = 'none'); // ä»–ã‚’é–‰ã˜ã‚‹
                    content.style.display = isVisible ? 'none' : 'block'; // ç¾åœ¨ã®çŠ¶æ…‹ã‚’åˆ‡ã‚Šæ›¿ãˆ
                });
            });
        }

        function addSortListeners() {
            const headers = document.querySelectorAll('.accordion-content th');
            headers.forEach(header => {
                header.addEventListener('click', (event) => {
                    // ä¿®æ­£: <select>è¦ç´ ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸå ´åˆã¯ã‚½ãƒ¼ãƒˆã‚’å®Ÿè¡Œã—ãªã„
                    if (event.target.tagName === 'SELECT') return;

                    const key = header.dataset.key;
                    const isSameKey = sortState.key === key;
                    sortState = { key, isAscending: isSameKey ? !sortState.isAscending : true };

                    // ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã®é–‹é–‰çŠ¶æ…‹ã‚’ä¿å­˜
                    const accordionState = Array.from(document.querySelectorAll('.accordion-header')).map(header => {
                        const content = header.nextElementSibling;
                        return content.style.display === 'block';
                    });

                    // ç¾åœ¨ã®ãƒªã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®é¸æŠçŠ¶æ…‹ã‚’ä¿å­˜
                    const filterStates = saveFilterStates();

                    // ä¿®æ­£: ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«ã‚½ãƒ¼ãƒˆ
                    const dataToSort = filteredData.length ? filteredData : originalData;
                    const groupedData = groupBy(dataToSort, 'ã‚¸ãƒ£ãƒ³ãƒ«');
                    const sortedData = Object.keys(groupedData).reduce((result, genre) => {
                        const sortedGroup = [...groupedData[genre]].sort((a, b) => {
                            const valA = (a[key] || '').toString().toLowerCase();
                            const valB = (b[key] || '').toString().toLowerCase();
                            if (valA < valB) return sortState.isAscending ? -1 : 1;
                            if (valA > valB) return sortState.isAscending ? 1 : -1;
                            return 0;
                        });
                        result[genre] = sortedGroup;
                        return result;
                    }, {});

                    document.querySelectorAll('.accordion-content th').forEach(th => th.classList.remove('ascending', 'descending'));
                    header.classList.add(sortState.isAscending ? 'ascending' : 'descending');

                    renderAccordion(Object.values(sortedData).flat());

                    // ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã®é–‹é–‰çŠ¶æ…‹ã‚’å¾©å…ƒ
                    restoreAccordionState(accordionState);

                    // ãƒªã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®é¸æŠçŠ¶æ…‹ã‚’å¾©å…ƒ
                    restoreFilterStates(filterStates);
                });
            });
        }

        function restoreAccordionState(state) {
            const headers = document.querySelectorAll('.accordion-header');
            headers.forEach((header, index) => {
                const content = header.nextElementSibling;
                content.style.display = state[index] ? 'block' : 'none';
            });
        }

        function saveFilterStates() {
            const filterStates = {};
            const filterElements = document.querySelectorAll('select[id^="filter"]');
            filterElements.forEach(filter => {
                filterStates[filter.id] = filter.value;
            });
            return filterStates;
        }

        function restoreFilterStates(filterStates) {
            Object.keys(filterStates).forEach(filterId => {
                const filterElement = document.getElementById(filterId);
                if (filterElement) {
                    filterElement.value = filterStates[filterId];
                }
            });
        }

        function populateFilterOptions(selectElement, key, data) {
            const uniqueVals = [...new Set(data.map(item => item[key] || ''))].sort();
            selectElement.innerHTML = '<option value="">å…¨ã¦</option>' + uniqueVals.map(val => `<option value="${val}">${val}</option>`).join('');
        }

        function filterTable() {
            const groupedData = groupBy(originalData, 'ã‚¸ãƒ£ãƒ³ãƒ«');
            filteredData = []; // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ

            Object.keys(groupedData).forEach(genre => {
                const filterç”¨é€”Element = document.getElementById(`filterç”¨é€”-${genre}`);
                const filteræ–™é‡‘Element = document.getElementById(`filteræ–™é‡‘-${genre}`);
                const filterNSFWElement = document.getElementById(`filterNSFW-${genre}`);

                const selectedç”¨é€” = filterç”¨é€”Element.value;
                const selectedæ–™é‡‘ = filteræ–™é‡‘Element.value;
                const selectedNSFW = filterNSFWElement.value;

                const filtered = groupedData[genre].filter(item => {
                    const matchesç”¨é€” = !selectedç”¨é€” || item['ç”¨é€”'] === selectedç”¨é€”;
                    const matchesæ–™é‡‘ = !selectedæ–™é‡‘ || item['æ–™é‡‘'] === selectedæ–™é‡‘;
                    const matchesNSFW = !selectedNSFW || item['NSFWå¯¾å¿œ'] === selectedNSFW;

                    return matchesç”¨é€” && matchesæ–™é‡‘ && matchesNSFW;
                });

                filteredData = filteredData.concat(filtered); // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°çµæœã‚’ä¿æŒ

                // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°çµæœã‚’è©²å½“ã‚¸ãƒ£ãƒ³ãƒ«ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«åæ˜ 
                const section = Array.from(document.querySelectorAll('.accordion-header')).find(header => header.textContent === genre);
                if (section) {
                    const tbody = section.nextElementSibling.querySelector('tbody');
                    tbody.innerHTML = filtered.map(item => `
                        <tr>
                            <td>${item['ç”¨é€”'] || ''}</td>
                            <td><a href="${item['URL'] || '#'}" target="_blank">${item['ãƒ„ãƒ¼ãƒ«å'] || ''}</a></td>
                            <td>${item['æ–™é‡‘'] || ''}</td>
                            <td>${item['NSFWå¯¾å¿œ'] || ''}</td>
                            <td>${item['å‚™è€ƒ'] || ''}</td>
                        </tr>
                    `).join('');
                }

                // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¾Œã«ãƒªã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ›´æ–°
                updateFilterOptions(genre, filtered);

                // ä¿®æ­£: é¸æŠçŠ¶æ…‹ã‚’ä¿æŒ
                filterç”¨é€”Element.value = selectedç”¨é€”;
                filteræ–™é‡‘Element.value = selectedæ–™é‡‘;
                filterNSFWElement.value = selectedNSFW;
            });
        }

        function updateFilterOptions(genre, filteredData) {
            const allData = groupBy(originalData, 'ã‚¸ãƒ£ãƒ³ãƒ«')[genre];
            populateFilterOptions(document.getElementById(`filterç”¨é€”-${genre}`), 'ç”¨é€”', filteredData.length ? filteredData : allData);
            populateFilterOptions(document.getElementById(`filteræ–™é‡‘-${genre}`), 'æ–™é‡‘', filteredData.length ? filteredData : allData);
            populateFilterOptions(document.getElementById(`filterNSFW-${genre}`), 'NSFWå¯¾å¿œ', filteredData.length ? filteredData : allData);
        }

        function addEventListeners() {
            const filterElements = document.querySelectorAll('select[id^="filter"]');
            filterElements.forEach(filter => {
                filter.addEventListener('change', filterTable);
            });
        }
    </script>
</body>
<footer>
    <div class="social-icons">
        <a href="#" aria-label="Twitter">ğŸ¦</a>
        <a href="#" aria-label="Facebook">ğŸ“˜</a>
        <a href="#" aria-label="Instagram">ğŸ“¸</a>
    </div>
    <p>&copy; 2025 Evolvance All Rights Reserved.</p>
</footer>

</html>